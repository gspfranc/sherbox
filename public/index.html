<html>
  <head>
    <link href="/css/bootstrap.css" rel="stylesheet"/>
    <link href="/css/style.css" rel="stylesheet"/>
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/sjcl.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="page-header">
        <h1>SherBox <small>securly share your files</small></h1>
      </div>

      <div id="filepicker" class="row">
        <div class="col-md-10 col-md-offset-1">
          <input type="file" id="files" name="files[]" multiple/>
        </div>
      </div>

      <div class="row">
        <div id="dropbox" class="well col-md-10 col-md-offset-1">
          <p>Drag and drop your files here</p>
        </div>
      </div>

      <div class="row">
        <ul id="list" class="list-inline">
          <li class="well">filename</li>
          <li class="well">filename</li>
          <li class="well">filename</li>
        </ul>
      </div>
    </div>

    <script>
      function handleFiles(files) {
        for (var i = 0, f; f = files[i]; i++) {
          var file = files[i];
          var reader = new FileReader();
          reader.readAsBinaryString(file);

          reader.onloadend = function(evt) {
            console.log(file);
            var crypt = sjcl.encrypt("password", reader.result);
            //console.log(crypt);
            $("#list").append('<li class="well">' + file.name  + '</li>')
          }
        }
      }

      function handleFileSelect(e) {
        e.stopPropagation();
        e.preventDefault();

        var files = e.target.files; // FileList object
        handleFiles(files);
      }

      function drop(e) {
        e.stopPropagation();
        e.preventDefault();

        var dt = e.dataTransfer;
        var files = dt.files;

        handleFiles(files);
      }

      $('#files').on('change', handleFileSelect);

      $("#dropbox").on('drop', drop);
    </script>
  </body>
</html>
